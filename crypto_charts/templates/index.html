{% extends 'base.html' %}
{% block header %}
    {% block title %} {% endblock title %}

{% endblock header %}
{% block content %}
    <hr>
    <form name="get_coin" action="/" method="POST">
        <label> Para walutowa: </label>
        <input name="coin1" id="coin1" required>-<input name="coin2" id="coin2">
        <label> Giełda: </label>
        <select name="exchanges" size="3" multiple>
            {% for exchange in exchanges_list %}
            <option value="{{ exchange }}">{{ exchange }}</option>
            {% endfor %}
        </select>
        <input type="submit" value="Wyszukaj">
    </form>
    <hr>

    {% for message in get_flashed_messages() %}
        <div class="flash">{{ message }}</div>
    {% endfor %}
    {% if request.method == 'POST' and symbol and exchanges %}
        <p> Para: {{ symbol }} </p>
        <table>
            <tr>
                <th>Giełda</th>
                <th>Aktualna cena [{{ quote_currency }}]</th>
                <th>Zmiana ceny (24h) [{{ quote_currency }}]</th>
                <th>Wolumen</th>
            </tr>
            {% for exchange in stats_data.keys() %}
            <tr>
                <td> <b> {{ exchange }} </b></td>
                <td> {{ stats_data[exchange].last_price }} </td>
                <td> {{ stats_data[exchange].change_price_24 }} </td>
                <td> {{ stats_data[exchange].volume }} </td>
            </tr>
            {% endfor %}
        </table>
        {% block stats_chart %}
        <script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
            <div id='price_chart' class='chart'></div>
            <script type='text/javascript'>
                var graphs = {{ graph_price_json | safe}};
                Plotly.plot('price_chart',graphs,{});
            </script>
            <div id='vol_chart' class='chart'></div>
            <script type='text/javascript'>
                var graphs = {{ graph_vol_json | safe}};
                Plotly.plot('vol_chart',graphs,{});
            </script>
        {% endblock stats_chart %}
    {% endif %}
{% endblock content %}
